<?xml version="1.0" encoding="UTF-8"?>
<?import javafx.scene.canvas.Canvas?>
<?import javafx.scene.control.*?>
<?import javafx.scene.layout.*?>
<?import javafx.scene.shape.Rectangle?>

<BorderPane xmlns="http://javafx.com/javafx/11.0.1"
            xmlns:fx="http://javafx.com/fxml/1"
            fx:controller="com.example.dungeon.ui.GameController"
            prefWidth="1200" prefHeight="800"
            stylesheets="@../styles/game.css"
            styleClass="root-pane">

    <!-- TOP: HUD -->
    <top>
        <HBox spacing="20" styleClass="top-bar" style="-fx-padding: 14;">
            <!-- Player HUD -->
            <VBox spacing="8" prefWidth="320" styleClass="hud-block">
                <Label text="Ð’ÐÐ¨ ÐŸÐ•Ð Ð¡ÐžÐÐÐ–" styleClass="section-title"/>
                <HBox spacing="12" alignment="CENTER_LEFT">
                    <VBox spacing="4" prefWidth="180">
                        <Label fx:id="playerCharacterLabel" text="Ð—Ð°Ð³Ñ€ÑƒÐ·ÐºÐ°..." styleClass="char-name"/>
                        <Label fx:id="playerHealthLabel" text="HP: ?/?" styleClass="hp-label"/>
                        <Label fx:id="playerShieldLabel" text="Ð©Ð¸Ñ‚: 0" styleClass="shield-label"/>
                    </VBox>
                    <Canvas fx:id="playerHealthCanvas" width="220" height="22" styleClass="health-canvas"/>
                </HBox>
            </VBox>

            <!-- Center status with Victory Indicator -->
            <VBox spacing="10" alignment="CENTER" HBox.hgrow="ALWAYS" styleClass="center-hud">
                <Label fx:id="gameStatusLabel" text="ÐžÐ¶Ð¸Ð´Ð°Ð½Ð¸Ðµ..." styleClass="status-label"/>

                <!-- Victory Indicator Canvas -->
                <StackPane fx:id="victoryContainer" style="-fx-padding: 0 0 8 0;">
                    <Canvas fx:id="victoryIndicatorCanvas" width="120" height="120"
                            styleClass="victory-indicator"/>
                    <VBox alignment="CENTER" spacing="2">
                        <Label fx:id="victoryPercentageLabel" text="50%" styleClass="victory-percentage"/>
                        <Label fx:id="victoryStatusLabel" text="Ð ÐÐ’ÐÐžÐ’Ð•Ð¡Ð˜Ð•" styleClass="victory-status"/>
                    </VBox>
                </StackPane>

                <HBox spacing="8" alignment="CENTER">
                    <Label fx:id="turnIndicator" text="â³" styleClass="turn-icon"/>
                    <Label fx:id="gameTimerLabel" text="00:00" styleClass="timer-label"/>
                </HBox>
                <Label fx:id="lastActionLabel" text="Ð“Ð¾Ñ‚Ð¾Ð² Ðº Ð±Ð¾ÑŽ" styleClass="action-label"/>
            </VBox>

            <!-- Opponent HUD -->
            <VBox spacing="8" prefWidth="320" alignment="CENTER_RIGHT" styleClass="hud-block">
                <Label text="ÐŸÐ ÐžÐ¢Ð˜Ð’ÐÐ˜Ðš" styleClass="section-title" />
                <HBox spacing="12" alignment="CENTER_RIGHT">
                    <Canvas fx:id="opponentHealthCanvas" width="220" height="22" styleClass="health-canvas"/>
                    <VBox spacing="4" alignment="CENTER_RIGHT" prefWidth="180">
                        <Label fx:id="opponentCharacterLabel" text="Ð—Ð°Ð³Ñ€ÑƒÐ·ÐºÐ°..." styleClass="char-name"/>
                        <Label fx:id="opponentHealthLabel" text="HP: ?/?" styleClass="hp-label"/>
                        <Label fx:id="opponentShieldLabel" text="Ð©Ð¸Ñ‚: 0" styleClass="shield-label"/>
                    </VBox>
                </HBox>
            </VBox>
        </HBox>
    </top>

    <!-- CENTER: battlefield + cards -->
    <center>
        <VBox spacing="18" alignment="CENTER" style="-fx-padding:18;" >
            <Label text="ÐšÐÐ Ð¢Ð« ÐŸÐ ÐžÐ¢Ð˜Ð’ÐÐ˜ÐšÐ" styleClass="cards-title"/>
            <HBox fx:id="opponentCardsContainer" spacing="12" alignment="CENTER"/>

            <Canvas fx:id="battleAnimationCanvas" width="720" height="120" visible="false"/>

            <Separator prefWidth="820"/>

            <Label text="Ð’ÐÐ¨Ð˜ ÐšÐÐ Ð¢Ð«" styleClass="cards-title"/>
            <HBox fx:id="playerCardsContainer" spacing="16" alignment="CENTER">
                <!-- sample hidden template card; CardFactory Ð´Ð¾Ð»Ð¶ÐµÐ½ ÐºÐ»Ð¾Ð½Ð¸Ñ€Ð¾Ð²Ð°Ñ‚ÑŒ/Ñ€ÐµÐ½Ð´ÐµÑ€Ð¸Ñ‚ÑŒ Ð¿Ð¾Ñ…Ð¾Ð¶Ð¸Ðµ Ð½Ð¾Ð´Ñ‹ -->
                <StackPane fx:id="sampleCard" visible="false" styleClass="card-pane" prefWidth="140" prefHeight="180">
                    <VBox alignment="CENTER" spacing="6">
                        <Label text="ðŸ”¥" styleClass="card-emoji"/>
                        <Label text="ÐžÐ³Ð½ÐµÐ½Ð½Ñ‹Ð¹ ÑˆÐ°Ñ€" styleClass="card-name"/>
                        <Label text="Attack 6" styleClass="card-value"/>
                    </VBox>
                    <Rectangle styleClass="card-overlay" width="140" height="180" />
                </StackPane>
            </HBox>
        </VBox>
    </center>

    <!-- RIGHT: chat -->
    <right>
        <VBox spacing="12" prefWidth="340" styleClass="chat-panel" style="-fx-padding: 12;">
            <HBox spacing="8" alignment="CENTER_LEFT">
                <Label text="Ð‘ÐžÐ•Ð’ÐžÐ™ Ð§ÐÐ¢" styleClass="chat-title"/>
                <!-- Ð¼Ð°Ð»ÐµÐ½ÑŒÐºÐ°Ñ Ð¿Ð¾Ð´ÑÐºÐ°Ð·ÐºÐ° -->
                <Label text="â€¢" style="-fx-text-fill: rgba(255,255,255,0.08);"/>
            </HBox>

            <TextArea fx:id="gameChatArea" editable="false" wrapText="true" VBox.vgrow="ALWAYS" styleClass="chat-area"/>

            <HBox spacing="8">
                <TextField fx:id="gameMessageField" promptText="ÐÐ°Ð¿Ð¸ÑÐ°Ñ‚ÑŒ..." HBox.hgrow="ALWAYS" onAction="#sendGameChatMessage" styleClass="chat-input"/>
                <Button text="âž¤" onAction="#sendGameChatMessage" styleClass="send-button"/>
            </HBox>
        </VBox>
    </right>

    <!-- BOTTOM -->
    <bottom>
        <HBox spacing="14" alignment="CENTER" styleClass="bottom-bar" style="-fx-padding: 12;">
            <Button text="Ð¡Ð´Ð°Ñ‚ÑŒÑÑ" onAction="#surrender" />
            <Button text="ÐŸÑ€Ð°Ð²Ð¸Ð»Ð°" onAction="#showRules" />
            <Button text="ÐœÐµÐ½ÑŽ" onAction="#returnToMenu" />
        </HBox>
    </bottom>
</BorderPane>
